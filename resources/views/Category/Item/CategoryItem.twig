{% extends getPartial('page-design') %}
{% import "CeresCoconut::Category.Macros.CategoryTree" as Tree %}
{% import "Ceres::PageDesign.Macros.LayoutContainer" as LayoutContainer %}

{% block PageBody %}

    {{ component( "Ceres::ItemList.Components.Filter.ItemFilterList") }}
    {{ component( "Ceres::ItemList.Components.Filter.ItemFilterTagList") }}
    {{ component( "Ceres::ItemList.Components.ItemList") }}
    {{ component( "Ceres::ItemList.Components.CategoryImageCarousel") }}
    {{ component( "CeresCoconut::Category.Item.Partials.ItemSorting") }}
    {{ component( "Ceres::ItemList.Components.ItemsPerPage") }}
    {{ component( "CeresCoconut::Category.Item.Partials.PaginationETC") }}

    {% if ceresConfig.item.showCategoryImage %}
        {% include "Ceres::Category.Item.Partials.CategoryParallaxImage" with { 'category': category } %}
    {% endif %}

    {% set shippingCat = config("Ceres.global.shippingCostsCategoryId") %}

    <div class="container categoryView isGridView isList-1">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 CategoryItemList">
          <div class="category-title">{{ trans("Ceres::Template.itemCategories") }}</div>
            <div class="col-lg-3 col-md-3 filterSubnavigationPanel">
            <div class="SubnavigationTitle ITEMFILTERTAGLIST"><span class="hidden-xs">{{ trans("CeresCoconut::Template.ETC_SucheEingrenzen") }}</span><span class="hidden-lg"><i class="material-icons w3-xxxlarge">filter_list</i></span></div>
              <div id="SubnavigationContent">
                {{ include('CeresCoconut::PageDesign.Partials.Header.SideNavigationETC.twig') }}
                <item-filter-tag-list></item-filter-tag-list>
                {% set overrideSearchFilters = LayoutContainer.show("Ceres::Search.Filter", facets ) %}
                {% if overrideSearchFilters | trim is empty %}
                  <item-filter-list :facet-data="{{ facets | json_encode }}"></item-filter-list>
                {% else %}
                  {{ overrideSearchFilters }}
                {% endif %}
              </div>
          </div>
          <div class="categoryPagination row margin-top-2 margin-bottom-2 col-lg-9">
            <nav class="navbar navbar-default">
              {% if ceresConfig.pagination.position in ['top', 'top_bottom'] %}
                <!--<pagination template="#vue-paginationETC"></pagination>
                <noscript>-->
                  {% include "CeresCoconut::Category.Item.Partials.PaginationETC" %}
                <!--</noscript>-->
              {% endif %}

              <ul class="nav navbar-right col-lg-8">
                <li>
                  <span>{{ itemCountTotal }} {{ trans("CeresCoconut::Template.ETC_Artikel") }}</span>
                </li>
                <li>
                  {% include "CeresCoconut::Category.Item.Partials.ItemSorting" with { 'sortingData': searchOptions.sorting, 'selectedSorting': itemSorting } %}
                  {% include "Ceres::Category.Item.Partials.ItemsPerPage" with { 'itemsPerPage': searchOptions.itemsPerPage, 'selectedValue': itemsPerPage } %}
                  <!--<item-list-sorting template="#vue-item-list-sortingETC" :sorting-list="{{ searchOptions.sorting | json_encode }}" :default-sorting="{{ searchOptions.defaultSorting | json_encode }}"></item-list-sorting>
                  <items-per-page
                    template="#vue-items-per-page"
                    :pagination-values="{{ searchOptions.itemsPerPage | json_encode }}"></items-per-page>-->
                </li>
              </ul>
            </nav>
          </div>
          {# TAGS
          <item-filter-tag-list></item-filter-tag-list>#}

          {% if ceresConfig.header.showNavBars == "side" or ceresConfig.header.showNavBars == "both" %}
            <div class="col-xs-3 hidden-md-down">
              <div class="sidebar-categories">
                <div class="category-title">{{ trans("Ceres::Template.itemCategories") }}</div>
                {{ include('Ceres::PageDesign.Partials.Header.SideNavigation.twig') }}
              </div>
              {{ LayoutContainer.show("Ceres::CategoryItem.SideNavBarBottom") }}
            </div>
          {% endif %}
<!--        <div class="row">

            <div class="col-xs-12 col-lg-{% if ceresConfig.header.showNavBars == "side" or ceresConfig.header.showNavBars == "both" %}9{% else %}12{% endif %}">

                <div id="twig-rendered-item-list" class="item-list-frame{% if ceresConfig.item.loadingAnimationType == "blur" %} blur-effect{% endif %}">
-->
                    {% if ceresConfig.item.loadingAnimationType != "blur" %}
                        {% include "Ceres::ItemList.Partials.LoadingAnimation" %}
                    {% endif %}

                    <ul id="twig-rendered-item-list" class="row categoryDetails isGridView col-lg-9">
                        {% for item in itemList %}
                          {% include "CeresCoconut::Category.Item.Partials.CategoryListItemETC" with { 'item': item, 'shippingCat': shippingCat } %}
                        {% endfor %}
                    </ul>
<!--                    <div id="vue-rendered-item-list" style="display:none">
                      <item-list template="#vue-item-list" :total-items-data="{{ itemCountTotal }}" :category-id="{{ category.id }}"></item-list>
                    </div>
                </div>
            </div>
        </div>


        <div id="vue-rendered-item-list" style="display:none">
            <item-list template="#vue-item-list" :total-items-data="{{ itemCountTotal }}" :category-id="{{ category.id }}"></item-list>
        </div>
-->
        <div class="categoryPagination row margin-top-2 margin-bottom-2">
          <nav class="navbar navbar-default">
            {% if ceresConfig.pagination.position in ['top', 'top_bottom'] %}
                {% include "CeresCoconut::Category.Item.Partials.PaginationETC" %}
            {% endif %}
          </div>
        </div>
      </div>
    </div>

{% endblock %}

{% block PartialHead %}
    <script type="application/ld+json">{"@context": "http://schema.org","@type": "WebSite","url": "{{ webstoreConfig.domainSsl }}","potentialAction":{"@type": "SearchAction","target": "{{ domainSsl }}/search?query={search_term}","query-input": "required name=search_term"}}</script>

    {% if currentPage-1 > 0 %}
        <link rel="prev" href="{{ webstoreConfig.domainSsl }}?{{ query | merge({'page' : currentPage-1 }) | url_encode }}" />
    {% endif %}

    {% if currentPage+1 <= pageMax %}
        <link rel="next" href="{{ webstoreConfig.domainSsl }}?{{ query | merge({'page' : currentPage+1 }) | url_encode }}" />
    {% endif %}

    <title>{{ config("Ceres.header.company_name") }} - {% if category.details[0].metaTitle %}{{ category.details[0].metaTitle }}{% else %}{{ category.details[0].name }}{% endif %}</title>

    <meta name="description" content="{{ category.details[0].metaDescription }}">
    <meta name="keywords" content="{{ category.details[0].metaKeywords }}">

    <meta name="robots" content="{{ metaRobots }}">
    {% set BelboonTrackActive = config("CeresCoconut.tracking.belboonTrackingActive") %}
    {% if BelboonTrackActive == "true" %}
      <script type="text/javascript">
        belboonTag = {
            categoryId: "{{ category.id }}"
        };
      </script>
      <script type="text/javascript">
          (function(d) {
              var s = d.createElement("script");
              s.async = true;
              s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//containertags.belboon.de/belboonTag.js.php?pId=18842&page=category&type=dynamic";
              var a = d.getElementsByTagName("script")[0];
              a.parentNode.insertBefore(s, a);
          }(document));
      </script>
    {% endif %}


{% endblock %}
